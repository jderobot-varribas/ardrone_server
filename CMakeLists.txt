
if(ARDRONE_ALL_DEPS)

	set(CMAKE_CXX_FLAGS "-w -lIce -lIceUtil")

	include_directories(
		${INTERFACES_CPP_DIR}
		${OpenCV_INCLUDE_DIR}
		${Ice_INCLUDE_DIR}
		${LIBS_DIR}
		${Boost_INCLUDE_DIR}
		${EIGEN_INCLUDE_DIR}
		${libxmlpp_INCLUDE_DIRS}
		${ardronelib_INCLUDE_DIRS})

	link_directories(
		${ardronelib_LIBRARY_DIRS})

        include_directories(include)


	add_executable(ardrone_server src/ardrone_driver.cpp 
					src/video.cpp 
					src/ardrone_sdk.cpp 
					src/teleop_twist.cpp
					src/components/cameraserver.cpp 
					src/components/cmdveli.cpp				
					src/components/pose3di.cpp
					src/components/remoteconfigi.cpp
					src/components/navdatai.cpp
					src/components/ardroneextrai.cpp
					src/ardrone_parser.cpp
					src/ardrone_config.cpp)

	target_link_libraries(ardrone_server 
				${ardronelib_LIBRARIES}
				SDL 
				${CMAKE_THREAD_LIBS_INIT})

	target_link_libraries(ardrone_server
				${OpenCV_LIBRARIES}
				${ZeroCIce_LIBRARIES}
				colorspacesmm
				JderobotInterfaces
				${libxmlpp_LIBRARIES})

	add_custom_command(TARGET ardrone_server POST_BUILD
		COMMAND ${CMAKE_COMMAND} -E copy_directory
			${CMAKE_CURRENT_SOURCE_DIR}/config $<TARGET_FILE_DIR:ardrone_server>/config)

	add_custom_command(TARGET ardrone_server POST_BUILD
		COMMAND ${CMAKE_COMMAND} -E copy_if_different
			${CMAKE_CURRENT_SOURCE_DIR}/ardrone_interfaces.cfg $<TARGET_FILE_DIR:ardrone_server>)


	if(DEFINED ARDRONE_TEST_PARSER)
		message(STATUS "Enable testing for ardrone_server")
		add_executable(test_parser test/test_parser.cpp src/ardrone_parser.cpp src/ardrone_config.cpp)
		set_target_properties(ardrone_server test_parser PROPERTIES COMPILE_DEFINITIONS "ARDRONE_TEST_PARSER")
	endif()

ELSE()
	message(WARNING "ardrone_server marked to build, but required dependencies were not met.
		You should install third party library: ardonelib")
ENDIF()
